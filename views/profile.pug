extends layoutprofile
include mixins/_tweetForm
include mixins/_tweetCard
block content
	.double_wrap
		.profile_section
			img.profile_avatar(src=`${reqUser.avatar || '/uploads/no-avatar.jpg'}` style="max-height:240px; max-width:240px")
			h2.profile_name(style="font-size:25px") #{reqUser.name || reqUser.username}
				if (reqUser.verified)
					img(src="/uploads/c4ze18c.png" width="30" height="30" style="vertical-align:middle; padding: 0px 0px 5px 5px;" title="Utilisateur vérifié")
			h4.profile_username @#{reqUser.username}
				if user && (reqUser.following.map(obj => obj.toString()).includes(user._id.toString())) && reqUser._id.toString() != user._id.toString()
					span.follows_you
						if user.lang == 'en'
							| Follows you
						else
							| Vous suit

			if user
				if user.lang == 'en'
					if (reqUser._id.toString() != user._id.toString())
						if (user.following.map(obj => obj.toString()).includes(reqUser._id.toString()))
							input(type="button" onclick=`window.location.href = "/api/users/${reqUser._id}/follow";` class='button followed_button' value=`Following`)
						else
							input(type="button" onclick=`window.location.href = "/api/users/${reqUser._id}/follow";` class='button follow_button' value=`Follow`)
				else
					if (reqUser._id.toString() != user._id.toString())
						if (user.following.map(obj => obj.toString()).includes(reqUser._id.toString()))
							input(type="button" onclick=`window.location.href = "/api/users/${reqUser._id}/follow";` class='button followed_button' value=`Suivi`)
						else
							input(type="button" onclick=`window.location.href = "/api/users/${reqUser._id}/follow";` class='button follow_button' value=`Suivre`)
			if user && user.lang == 'en'
				if reqUser.followers.length == 1
					h4
						a(href=`/${reqUser.username}/followers` class="followcount") #{reqUser.followers.length} follower
						| &nbsp;&bull;&nbsp;
						if reqUser.following.length - 1 == -1
							a(href=`/${reqUser.username}/following` class="followcount") 0 following
						else
							a(href=`/${reqUser.username}/following` class="followcount") #{reqUser.following.length - 1} following
				else
					h4
						a(href=`/${reqUser.username}/followers` class="followcount") #{reqUser.followers.length} followers
						| &nbsp;&bull;&nbsp;
						if reqUser.following.length - 1 == -1
							a(href=`/${reqUser.username}/following` class="followcount") 0 following
						else
							a(href=`/${reqUser.username}/following` class="followcount") #{reqUser.following.length - 1} following
			else
				if reqUser.followers.length == 1
					h4
						a(href=`/${reqUser.username}/followers` class="followcount") #{reqUser.followers.length} abonné
						| &nbsp;&bull;&nbsp;
						if reqUser.following.length - 1 == -1
							a(href=`/${reqUser.username}/following` class="followcount") 0 abonnements
						else if reqUser.following.length - 1 == 1
							a(href=`/${reqUser.username}/following` class="followcount") #{reqUser.following.length - 1} abonnement
						else
							a(href=`/${reqUser.username}/following` class="followcount") #{reqUser.following.length - 1} abonnements
				else
					h4
						a(href=`/${reqUser.username}/followers` class="followcount") #{reqUser.followers.length} abonnés
						| &nbsp;&bull;&nbsp;
						if reqUser.following.length - 1 == -1
							a(href=`/${reqUser.username}/following` class="followcount") 0 abonnements
						else if reqUser.following.length - 1 == 1
							a(href=`/${reqUser.username}/following` class="followcount") #{reqUser.following.length - 1} abonnement
						else
							a(href=`/${reqUser.username}/following` class="followcount") #{reqUser.following.length - 1} abonnements

			if user && user.lang == 'en'
				h4(style="font-size:14px") Joined Squakr in #{enmonths[new Date(reqUser.created).getMonth()]} #{new Date(reqUser.created).getFullYear()}
			else
				h4(style="font-size:14px") A rejoint Squakr en #{months[new Date(reqUser.created).getMonth()]} #{new Date(reqUser.created).getFullYear()}
			if reqUser.bio
				.profile_bio(style="white-space: pre-line; font-weight: bold;")
					| #{reqUser.bio}
				if !reqUser.website
					br
			if reqUser.website
				p
					i.fa.fa-link &nbsp;
					a(href=reqUser.website rel='no_follow' target='_blank' class="user_website")
						if reqUser.website.length > 25
							| #{reqUser.website.replace(/^https?\:\/\//i, "").substring(0, 25)}...
						else
							| #{reqUser.website.replace(/^https?\:\/\//i, "")}
			if user && user.lang == 'en'
				if reqUser.moderator
					img(src="/uploads/badge-community-moderator-1.svg" width="35" height = "35" title="Community moderator")
				if (reqUser.developer)
					img(src="/uploads/dV4jqpv6.png" width = "35" height = "35" title="Contributed to\nthe devloppement of Squakr. Thanks !")
				if reqUser.avatar
					img(src="/uploads/badge-profilepic.svg" width="35" height = "35" title="Added an avatar to his profile")
				if reqUser.banner
					img(src="/uploads/badge-banner-1.svg" width="35" height = "35" title="Added a banner to his profile")
				if reqUser.bio
					img(src="/uploads/badge-desc-1.svg" width="35" height = "35" title="Added a bio to his profile")
				if reqUser.website
					img(src="/uploads/badge-profile-link.svg" width="35" height = "35" title="Added a website to his profile")
				if (tweets[0] || pinned)
					img(src="/uploads/badge-profile-squak-1.svg" width="35" height = "35" title="Posted at least one squak")
				if ((tweets[9] && pinned) || (tweets[10]))
					img(src="/uploads/dth315yw.png" width = "44" title="Posted at least 11 squaks")
				if (likes[0])
					img(src="/uploads/nzVvRMFH.png" width="35" height = "35" title="Liked at least one squak")
				if (likes[10])
					img(src="/uploads/7brhRQ3g.png" width = "44" title="Liked at least 11 squaks")
				if (reqUser.likes > 0)
					img(src="/uploads/badge-profile-likes-1.svg" width="35" height = "35" title="Achieved 1 like on his squaks")
				if (reqUser.likes > 9)
					img(src="/uploads/badge-profile-likes-10.svg" width="35" height = "35" title="Achieved 10 likes on his squaks")
				if (reqUser.likes > 24)
					img(src="/uploads/badge-profile-likes-25.svg" width="35" height = "35" title="Achieved 25 likes on his squaks")
				if (reqUser.likes > 49)
					img(src="/uploads/badge-profile-likes-50.svg" width="35" height = "35" title="Achieved 50 likes on his squaks")
				if (reqUser.likes > 99)
					img(src="/uploads/badge-profile-likes-100.svg" width="35" height = "35" title="Achieved 100 likes on his squaks")
				if (reqUser.likes > 249)
					img(src="/uploads/badge-profile-likes-250.svg" width="35" height = "35" title="Achieved 250 likes on his squaks")
				if (reqUser.likes > 499)
					img(src="/uploads/badge-profile-likes-500.svg" width="35" height = "35" title="Achieved 500 likes on his squaks")
				if (reqUser.likes > 999)
					img(src="/uploads/badge-profile-likes-1000.svg" width="35" height = "35" title="Achieved 1000 likes on his squaks")
				if (reqUser.likes > 4999)
					img(src="/uploads/badge-profile-likes-5000.svg" width="35" height = "35" title="Achieved 5000 likes on his squaks")
				if (((new Date() - new Date(reqUser.created)) / (1000 * 3600 * 24*365) > 1 ))
					img(src="/uploads/badge-years-1.svg" width = "35" height = "35" title="Member for 1 year")
				if (reqUser.confirmed)
					img(src="/uploads/h0rt91tr.png" width = "35" height = "35" title="Confirmed his email address")
			else
				if reqUser.moderator
					img(src="/uploads/badge-community-moderator-1.svg" width="35" height = "35" title="Modérateur de la communauté")
				if (reqUser.developer)
					img(src="/uploads/dV4jqpv6.png" width = "35" height = "35" title="A été d'une aide précieuse pendant\nle dévelopemment de Squakr. Merci !")
				if reqUser.avatar
					img(src="/uploads/badge-profilepic.svg" width="35" height = "35" title="A ajouté un avatar à son profil")
				if reqUser.banner
					img(src="/uploads/badge-banner-1.svg" width="35" height = "35" title="A ajouté une image de bannière à son profil")
				if reqUser.bio
					img(src="/uploads/badge-desc-1.svg" width="35" height = "35" title="A ajouté une biographie à son profil")
				if reqUser.website
					img(src="/uploads/badge-profile-link.svg" width="35" height = "35" title="A ajouté un site web à son profil")
				if (tweets[0] || pinned)
					img(src="/uploads/badge-profile-squak-1.svg" width="35" height = "35" title="A publié au moins un squak")
				if ((tweets[9] && pinned) || (tweets[10]))
					img(src="/uploads/dth315yw.png" width = "44" title="A publié au moins 11 squaks")
				if (likes[0])
					img(src="/uploads/nzVvRMFH.png" width="35" height = "35" title="A liké au moins un squak")
				if (likes[10])
					img(src="/uploads/7brhRQ3g.png" width = "44" title="A liké au moins 11 squaks")
				if (reqUser.likes > 0)
					img(src="/uploads/badge-profile-likes-1.svg" width="35" height = "35" title="A atteint 1 like sur ses squaks")
				if (reqUser.likes > 9)
					img(src="/uploads/badge-profile-likes-10.svg" width="35" height = "35" title="A atteint 10 likes sur ses squaks")
				if (reqUser.likes > 24)
					img(src="/uploads/badge-profile-likes-25.svg" width="35" height = "35" title="A atteint 25 likes sur ses squaks")
				if (reqUser.likes > 49)
					img(src="/uploads/badge-profile-likes-50.svg" width="35" height = "35" title="A atteint 50 likes sur ses squaks")
				if (reqUser.likes > 99)
					img(src="/uploads/badge-profile-likes-100.svg" width="35" height = "35" title="A atteint 100 likes sur ses squaks")
				if (reqUser.likes > 249)
					img(src="/uploads/badge-profile-likes-250.svg" width="35" height = "35" title="A atteint 250 likes sur ses squaks")
				if (reqUser.likes > 499)
					img(src="/uploads/badge-profile-likes-500.svg" width="35" height = "35" title="A atteint 500 likes sur ses squaks")
				if (reqUser.likes > 999)
					img(src="/uploads/badge-profile-likes-1000.svg" width="35" height = "35" title="A atteint 1000 likes sur ses squaks")
				if (reqUser.likes > 4999)
					img(src="/uploads/badge-profile-likes-5000.svg" width="35" height = "35" title="A atteint 5000 likes sur ses squaks")
				if (((new Date() - new Date(reqUser.created)) / (1000 * 3600 * 24*365) > 1 ))
					img(src="/uploads/badge-years-1.svg" width = "35" height = "35" title="Membre depuis 1 an")
				if (reqUser.confirmed)
					img(src="/uploads/h0rt91tr.png" width = "35" height = "35" title="A confirmé son adresse email")
			if user
				if (reqUser._id.toString() == user._id.toString())
					p
						.edit_button
							if user.lang == 'en'
								input(type="button" onclick="window.location.href = '/settings/account';" class='button edit_button' value='Edit your profile')
							else
								input(type="button" onclick="window.location.href = '/settings/account';" class='button edit_button' value='Modifier vos informations')
				if ((user.moderator) && !(reqUser.verified) && (reqUser._id.toString() != user._id.toString()))
					p
						.edit_button
							if user.lang == 'en'
								input(type="button" onclick=`window.location.href = '/api/users/${reqUser._id}/verify';` class='button edit_button' value='Verify user')
							else
								input(type="button" onclick=`window.location.href = '/api/users/${reqUser._id}/verify';` class='button edit_button' value='Vérifier l\'utilisateur')
				if ((user.moderator) && !(reqUser.confirmed))
					p
						.edit_button
							if user.lang == 'en'
								input(type="button" onclick=`window.location.href = '/api/users/${reqUser._id}/confirm';` class='button edit_button' value='Confirm user')
							else
								input(type="button" onclick=`window.location.href = '/api/users/${reqUser._id}/confirm';` class='button edit_button' value='Confirmer l\'utilisateur')
				if user.devmode
					p
						.edit_button
							if user.lang == 'en'
								input(type="button" onclick=`window.location.href = '/${reqUser.username}/json';` class='button edit_button' value='Access JSON data')
								br
								br
								input(type="button" onclick=`window.location.href = '/id/${reqUser._id}';` class='button edit_button' value='Copy ID')
							else
								input(type="button" onclick=`window.location.href = '/${reqUser.username}/json';` class='button edit_button' value='Accéder aux données JSON')
								br
								br
								input(type="button" onclick=`window.location.href = '/id/${reqUser._id}';` class='button edit_button' value='Copier l\'identifiant')
		.feed_section.single_content
			if user && reqUser._id.toString() == user._id.toString()
				+tweetForm()
			else
				.profile_banner(style=`background:url('${reqUser.banner || "/uploads/no-banner.jpg"}')`)
			nav
				a(href="#") Squaks
				a(href=`/${reqUser.username}/likes`) Likes
				.animation.start-home
			br
			if pinned
				.pinnedsquak
					h4(style="margin: 10px 0;")
						i.fa.fa-map-pin
						if user && user.lang == 'en'
							| &#32;Pinned squak
						else
							| &#32;Squak épinglé
					+tweetCard(pinned)
			each squak in tweets
				+tweetCard(squak)
